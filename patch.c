Index: crypto/heimdal/appl/telnet/libtelnet/encrypt.c
===================================================================
// Around line 736, make the following changes to fix the vulnerable code

     int dir = kp->dir;
     int ret = 0;
 
+    if (len > MAXKEYLEN)
+        len = 0;
+
     if (!(ep = (*kp->getcrypt)(*kp->modep))) {
 	if (len == 0)
 	    return;
      
      
Index: contrib/telnet/libtelnet/encrypt.c
===================================================================
// Around line 736, make the following changes to fix the vulnerable code

 	int dir = kp->dir;
 	int ret = 0;
 
+	if (len > MAXKEYLEN)
+		len = 0;
+
 	if (!(ep = (*kp->getcrypt)(*kp->modep))) {
 		if (len == 0)
 			return;
